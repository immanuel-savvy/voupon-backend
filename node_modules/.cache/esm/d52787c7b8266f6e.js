let express,cors,ds_conn,router,bodyParser,create_default_admin,reset_vendor_id,event_reminders,refresh_subscriptions;_b82‍.w("express",[["default",["express"],function(v){express=v}]]);_b82‍.w("cors",[["default",["cors"],function(v){cors=v}]]);_b82‍.w("./ds/conn",[["default",["ds_conn"],function(v){ds_conn=v}]]);_b82‍.w("./routes",[["default",["router"],function(v){router=v}]]);_b82‍.w("body-parser",[["default",["bodyParser"],function(v){bodyParser=v}]]);_b82‍.w("./handlers/starter",[["create_default_admin",["create_default_admin"],function(v){create_default_admin=v}]]);_b82‍.w("./handlers/voucher",[["reset_vendor_id",["reset_vendor_id"],function(v){reset_vendor_id=v}]]);_b82‍.w("./handlers/subscriptions",[["event_reminders",["event_reminders"],function(v){event_reminders=v}],["refresh_subscriptions",["refresh_subscriptions"],function(v){refresh_subscriptions=v}]]);











const app = express();
app.use(cors());
app.use(express.static(__dirname + "/assets"));
app.use(bodyParser.urlencoded({ extended: true, limit: "100mb" }));
app.use(bodyParser.json({ limit: "100mb" }));

app.use((req, res, next) => {
  if (req.header.vendor_id) {
    req.header.vendor_id = reset_vendor_id(req.header.vendor_id);
    req.body.vendor = req.header.vendor_id;
  }

  next();
});

router(app);

app.get("/", (req, res) =>
  res.send("<div><h1>Hi, its Voucher Africa.</h1></div>")
);

app.get("/developer", (req, res) => {
  res.sendFile(__dirname + "/assets/docs/index.html");
});

app.listen(1449, () => {
  ds_conn();

  create_default_admin();

  refresh_subscriptions();
  event_reminders();

  console.log("Voupon Backend started on :1449");
});
